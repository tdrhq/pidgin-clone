%define name       @PACKAGE@
%define version    @VERSION@
%define release    1
%define serial     1
%define prefix     /usr
%define sysconfdir /etc

Summary:	A client compatible with AOL's 'Instant Messenger'
Name:		%{name}
Version:	%{version}
Release:	%{release}
Serial:		%{serial}
Copyright:	GPL
Group:		Applications/Internet
Vendor:		Pimpin' Penguins
Url:		http://gaim.sf.net/
Source:		%{name}-%{version}.tar.gz
Packager:	Rob Flynn <rob@marko.net>
BuildRoot:	/var/tmp/%{name}-%{version}-root
Requires:	gtk+ >= 1.2.3

%description
Gaim allows you to talk to anyone using AOL's 
Instant Messenger service (you can sign up at http://www.aim.aol.com).  

It uses the TOC version of the AOL protocol, so your buddy list is 
stored on AOL's servers and can be retrieved from anywhere.

It contains many of the same features as AOL's IM client while at
the same time incorporating many new features.

Gaim also contains a multiple connection feature which consists of 
protocol plugins.  These plugins allow you to use gaim to connect 
to other chat services such as Yahoo!, ICQ, and IRC.

%package applet
Summary:	A Gnome client compatible with AOL's 'Instant Messenger'
Group:		Applications/Internet
Requires:	gtk+ >= 1.2.3

%description applet
Gaim allows you to talk to anyone using AOL's 
Instant Messenger service (you can sign up at http://www.aim.aol.com).  

It uses the TOC version of the AOL protocol, so your buddy list is 
stored on AOL's servers and can be retrieved from anywhere.

It contains many of the same features as AOL's IM client while at
the same time incorporating many new features.

Gaim also contains a multiple connection feature which consists of 
protocol plugins.  These plugins allow you to use gaim to connect 
to other chat services such as Yahoo!, ICQ, and IRC.

The applet sits in your Gnome panel. It has all the same functionality
as the regular application but takes less desktop space.

%prep
%setup

%build
CFLAGS="$RPM_OPT_FLAGS" ./configure --prefix=%{prefix} --disable-gnome
make
if [ -d $RPM_BUILD_ROOT ]; then rm -r $RPM_BUILD_ROOT; fi;
mkdir -p $RPM_BUILD_ROOT%{prefix}
make prefix=$RPM_BUILD_ROOT%{prefix} install
make -C src mostlyclean-compile
CFLAGS="$RPM_OPT_FLAGS" ./configure --prefix=%{prefix} --sysconfdir=%{sysconfdir} --enable-distrib
make -C src gaim_applet

%install
make DESTDIR=$RPM_BUILD_ROOT prefix=%{prefix} sysconfdir=%{sysconfdir} install

%files
%defattr(-,root,root)
%{prefix}/bin/gaim
%doc doc/the_penguin.txt doc/PROTOCOL doc/CREDITS NEWS COPYING AUTHORS doc/FAQ README README.plugins ChangeLog plugins/PERL-HOWTO HACKING
%attr(755,root,root) %{prefix}/lib/gaim/*
%{prefix}/share/locale/*/*/*
%{prefix}/share/pixmaps/gaim.xpm
%{prefix}/share/gnome/apps/Internet/gaim.desktop


%files applet
%defattr(-,root,root)
%attr(755,root,root) %{prefix}/bin/gaim_applet
%doc doc/the_penguin.txt doc/PROTOCOL doc/CREDITS NEWS COPYING AUTHORS doc/FAQ README README.plugins ChangeLog plugins/PERL-HOWTO HACKING
%{prefix}/lib/gaim/*
%{prefix}/share/locale/*/*/*
%{prefix}/share/pixmaps/gaim.xpm
%{prefix}/share/gnome/apps/Internet/gaim.desktop
%{sysconfdir}/CORBA/servers/*
%{prefix}/share/applets/Network/*

%clean
rm -r $RPM_BUILD_ROOT

%changelog
* Thu Sep 20 2001 Rob Flynn <rob@marko.net> (0.44 release)
- More sane scaling of buddy icons (intelligently scale to either 48x48 or 50x50 depending on icon)
- Have you ever had it happen where you cancel a login and Gaim starts using all the available processing power? I think I fixed that.
- Temporarily removed Jabber user registration, which wasn't working anyway.
- Added a spiffy Help button
- Wrote a plugin for all those people who miss having the chat rooms in their buddy lists (chatlist.so)
- Updated libfaim
- Added drop down selection to chat invitation
- Improved the look of the chat invitation dialog
- Improved the look of the proxy preferences
- event_im_recv and event_im_display_rcvd passed whether the message received was auto-response (see SIGNALS)
- IRC fixes (largly copied from X-Chat)
- Internal change to how preferences are stored
- Other bug fixes
- Option to hide buddy icons

* Thu Sep 06 2001 Rob Flynn <rob@marko.net> (0.43 release)
- Updated German Translation (thanks Daniel Seifert)
- Can change friendly name in MSN again
- Bug fixes
- Auto-reconnect plugin has exponential timeout (i.e. it tries after 8 seconds, then 16, then 32, etc. up to 17 minutes)
- Removed file transfer things from Napster. It didn't work well anyway. It'll be back eventually. (Does anyone even use napster anymore?)
